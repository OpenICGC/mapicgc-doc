{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\ud83d\uddfa  mapicgc-gl-js","text":"<p>LLibreria de mapes ICGC. Envoltori de MaplibreGL</p>"},{"location":"#temari","title":"Temari","text":""},{"location":"#installacio","title":"Instal.laci\u00f3","text":"<ul> <li>1.1.Instal\u00b7laci\u00f3 via NPM</li> <li>1.1.Instal\u00b7laci\u00f3 via CDN</li> </ul>"},{"location":"#exemples","title":"Exemples","text":"<ul> <li>2.1.Afegir marker</li> </ul>"},{"location":"#documentacio","title":"Documentaci\u00f3","text":"<ul> <li>3.1.Funcions</li> </ul>"},{"location":"#preguntes-frequents","title":"Preguntes freq\u00fcents","text":"<ul> <li>Preguntes freq\u00fcents</li> </ul>"},{"location":"#autor-i-contacte","title":"Autor i Contacte","text":"<p>Unitat Geostart, Institut Cartogr\u00e0fic i Geol\u00f2gic de Catalunya.</p>"},{"location":"1.1.Inst_npm/","title":"1.1. Via NPM","text":""},{"location":"1.1.Inst_npm/#installacio-amb-npm","title":"Instal\u00b7laci\u00f3 amb NPM","text":"<p>Si utilitzes npm (Node Package Manager) per gestionar les depend\u00e8ncies del teu projecte, segueix aquests passos:</p> <ol> <li> <p>Obre la teva terminal i navega fins al directori del teu projecte.</p> </li> <li> <p>Executa la seg\u00fcent comanda per instal\u00b7lar mapicgc-gl-js:</p> </li> </ol> <pre><code>npm install mapicgc-gl-js\n</code></pre> <p>Aix\u00f2 descarregar\u00e0 i instal\u00b7lar\u00e0 la llibreria al teu projecte.</p> <p>3.. Un cop completada la instal\u00b7laci\u00f3, pots importar la llibreria al teu codi:</p> <pre><code> const llibreria = require('mapicgc-gl-js'); //ES6\n</code></pre> <p>o</p> <pre><code>  import * as mapicgcgl from \"mapicgc-gl-js\"\n</code></pre> <p>Ara est\u00e0s llest per comen\u00e7ar a utilitzar mapicgc-gl-js, seguint l'exemple seg\u00fcent:</p> <pre><code>&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"utf-8\" /&gt;\n    &lt;title&gt;Exemple llibreria mapicgc-gl-js&lt;/title&gt;\n    &lt;meta\n      name=\"viewport\"\n      content=\"initial-scale=1,maximum-scale=1,user-scalable=no\"\n    /&gt;\n    &lt;link\n      href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\"\n      rel=\"stylesheet\"\n    /&gt;\n  &lt;/head&gt;\n  &lt;body type=\"module\"&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;script&gt;\n      import { Map } from \"mapicgc-gl-js\";\n\n      const map = mapicgcgl.Map({\n        container: \"map\",\n        style: \"topografic\",\n        center: [2.1464, 41.306],\n        zoom: 7.4,\n        maxZoom: 14,\n        hash: true,\n        pitch: 0,\n        attributionControl: false,\n      });\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p> See the Pen    example-map-001 by unitatgeostart (@unitatgeostart)   on CodePen. </p>"},{"location":"1.2.Inst_cdn/","title":"1.2. Via CDN","text":""},{"location":"1.2.Inst_cdn/#installacio-amb-cdn","title":"Instal\u00b7laci\u00f3 amb CDN","text":"<p>Si prefereixes utilitzar un CDN per incorporar la llibreria al teu projecte, pots seguir aquests passos:</p> <ol> <li> <p>Obre la teva terminal i navega fins al directori del teu projecte.</p> </li> <li> <p>Afegir la seg\u00fcent l\u00ednia al teu fitxer HTML, generalment col\u00b7locada dins la secci\u00f3 <code>&lt;head&gt;</code>:</p> </li> </ol> <pre><code>&lt;script src=\"https://betaserver.icgc.cat/cdn/mapicgc-gl-js/mapicgc-gl.js\"&gt;&lt;/script&gt;\n&lt;link\n  href=\"https://betaserver.icgc.cat/cdn/mapicgc-gl-js/mapicgc-gl.css\"\n  rel=\"stylesheet\"\n/&gt;\n</code></pre> <p>Aix\u00f2 carregar\u00e0 la llibreria directament des del CDN.    Ara est\u00e0s llest per utilitzar mapicgc-gl-js al teu projecte, seguint l'exemple seg\u00fcent:</p> <pre><code>&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"utf-8\" /&gt;\n    &lt;title&gt;Exemple llibreria mapicgc-gl-js&lt;/title&gt;\n    &lt;meta\n      name=\"viewport\"\n      content=\"initial-scale=1,maximum-scale=1,user-scalable=no\"\n    /&gt;\n    &lt;script src=\"https://betaserver.icgc.cat/cdn/mapicgc-gl-js/mapicgc-gl.js\"&gt;&lt;/script&gt;\n    &lt;link\n      href=\"https://betaserver.icgc.cat/cdn/mapicgc-gl-js/mapicgc-gl.css\"\n      rel=\"stylesheet\"\n    /&gt;\n    &lt;link\n      href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\"\n      rel=\"stylesheet\"\n    /&gt;\n    &lt;style&gt;\n      body {\n        margin: 0;\n        padding: 0;\n      }\n      #map {\n        position: absolute;\n        top: 0;\n        bottom: 0;\n        width: 100%;\n        height: 100%;\n      }\n    &lt;/style&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;script&gt;\n      const map = new mapicgcgl.Map({\n        container: \"map\",\n        style: \"topografic\",\n        center: [2.1464, 41.306],\n        zoom: 7.4,\n        maxZoom: 14,\n        hash: true,\n        pitch: 0,\n        attributionControl: false,\n      });\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p> See the Pen    example-map-001 by unitatgeostart (@unitatgeostart)   on CodePen. </p>"},{"location":"2.1.AddMarker/","title":"2.1.Afegir marker","text":""},{"location":"2.1.AddMarker/#afegir-un-marcador","title":"Afegir un marcador","text":"<p>.addmarker(options)</p> <p> See the Pen    Exemple AddMarker by unitatgeostart (@unitatgeostart)   on CodePen. </p> <p>CodePen</p> <pre><code>&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"utf-8\" /&gt;\n    &lt;title&gt;Exemple mapicgc-gl-js: Afegir marker&lt;/title&gt;\n    &lt;meta name=\"viewport\" content=\"initial-scale=1,maximum-scale=1,user-scalable=no\" /&gt;\n    &lt;script src=\"https://betaserver.icgc.cat/cdn/mapicgc-gl-js/mapicgc-gl.js\"&gt;&lt;/script&gt;\n    &lt;link href=\"https://betaserver.icgc.cat/cdn/mapicgc-gl-js/mapicgc-gl.css\" rel=\"stylesheet\" /&gt;\n    &lt;link href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\" rel=\"stylesheet\" /&gt;\n    &lt;style&gt;\n      body {\n        margin: 0;\n        padding: 0;\n      }\n      #map {\n        position: absolute;\n        top: 0;\n        bottom: 0;\n        width: 100%;\n        height: 100%;\n      }\n    &lt;/style&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;script&gt;\n      const map = new mapicgcgl.Map({\n              container: \"map\",\n              style: \"topografic\",\n              center: [2.1464, 41.306],\n              zoom: 7.4,\n              maxZoom: 14,\n              hash: true,\n              pitch: 0,\n              attributionControl: false,\n            });\n      let optionsMarker = {\n        coord: [2.119, 41.87],\n        text: \"Hola Test\",\n        textOffset: 25,\n        options: {},\n      };\n      map.addMarker(optionsMarker);\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"2.1.Funcions_doc%20copy/","title":"2.1.Funcions doc copy","text":""},{"location":"2.1.Funcions_doc%20copy/#descripcion","title":"Descripci\u00f3n","text":"<p>Nos han encargado realizar un mapa para visualizar edificios de Barcelona</p> <ul> <li> <p>Sabemos que la direccion Direccion General de Catastro ofrece servicio de descarga de edificios</p> <p>http://www.catastro.minhap.es/webinspire/index.html</p> </li> <li> <p>Sabemos tambi\u00e9n que existe un plugin de QGIS para hacer una descarga m\u00e1s f\u00e1cil el \"Spanish Inspire Catastral Downloader\"</p> </li> <li> <p>Mapbox.com nos ofrece opciones como servidor para hospedar y convertir datos a Vector-Tiles</p> </li> <li> <p>Mapbox tiene un estio mundial oscuro que tambi\u00e9n nos puede servir como fondo</p> <p>mapbox://styles/mapbox/dark-v10 </p> </li> <li> <p>En la specificaci\u00f3n de Style de Mapbox los pol\u00edgonos  tienen la propiedad \"paint\" \"fill-extrusion\" d\u00f3nde que puedo cambiar de color y extrudir geometrias por un valor de altura</p> <p>https://docs.mapbox.com/mapbox-gl-js/style-spec/#layers-fill-extrusion </p> </li> </ul>"},{"location":"2.1.Funcions_doc%20copy/#paso-1-preparamos-datos","title":"Paso 1: Preparamos datos","text":"<p>Descargamos archivo ya convertido contrucciones.zip</p> <p>No guarde\u00eds el archivo dentro de /geoweb</p> <p>Si quisieramos preparar los datos o descargar otro municipio</p> <pre><code>* Podr\u00edamos descargar todas las construcciones de Barcelona (321 mil pol\u00edgonos) directamente de la Direccion General de Catastro [http://www.catastro.minhap.es/webinspire/index.html](http://www.catastro.minhap.es/webinspire/index.html){target=_blank}\n\n* Descargar\u00edamos los  datos [http://www.catastro.minhap.es/INSPIRE/Buildings/08/08900-BARCELONA/A.ES.SDGC.BU.08900.zip](http://www.catastro.minhap.es/INSPIRE/Buildings/08/08900-BARCELONA/A.ES.SDGC.BU.08900.zip) o utilizar\u00edamos QGIS + complemento \"Spanish Inspire Catastral Downloader\"\n\n* Convertir\u00edamos el archivo **A.ES.SDGC.BU.08900.buildingpart.gml** a SHP  \"contrucciones.shp\" con QGIS (coordenadas lat/lon EPSG:4326)\n</code></pre>"},{"location":"2.1.Funcions_doc%20copy/#paso-2entramos-en-mapbboxcom-i-cargamos-los-datos","title":"Paso 2:Entramos en MapbBox.com i cargamos los datos","text":"<ul> <li> <p>Lo cargamos como Tileset dentro de MapBox, a\u00f1adimos contrucciones.zip SIN DESCOMPRIMIR</p> </li> <li> <p>Entramos en MapBox.com <code>Studio</code> --&gt; <code>Tilesets</code> --&gt;<code>New tileset</code> Arrastramos contrucciones.zip*</p> </li> <li> <p>Copiamos ID y nombre de la capa</p> </li> </ul> <p></p>"},{"location":"2.1.Funcions_doc%20copy/#paso-3crear-edificioshtml","title":"Paso 3:Crear edificios.html","text":"<p>En este ejemplo y en adelante vamos a reutilizar el archivo css /geoweb/css/estilobase.css\" que existe ya en nuestro proyecto</p> <p>El archivo estilobase.css es este</p> <p><pre><code>            body {\n                margin: 0;\n            }\n\n            #map {\n                height: 100%;\n                width: 100%;\n                background-color: #ffffff\n            }\n</code></pre> * Vamos a VSCode y creamos el archivo edificios.html dentro de /geoweb</p> <pre><code>    &lt;html&gt;\n    &lt;head&gt;\n    &lt;meta charset='utf-8' /&gt;\n    &lt;title&gt;Edificios&lt;/title&gt;\n    &lt;meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' /&gt;\n    &lt;script src='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js'&gt;&lt;/script&gt;\n    &lt;link href='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css' rel='stylesheet' /&gt;\n    &lt;link href='css/estilobase.css' rel='stylesheet' /&gt;\n\n\n    &lt;script&gt;\n        //A\u00f1adir vuestor token y/o estilo !!\n        var map;\n        function init() {\n            mapboxgl.accessToken =\n                'pk.eyJ1IjoiZ2lzbWFzdGVybTIiLCJhIjoiY2plZHhubTQxMTNoYzMza3Rqa3kxYTdrOCJ9.53B1E6mKD_EQOVb2Y0-SsA';\n             map = new mapboxgl.Map({\n                container: 'map',\n                style: 'mapbox://styles/mapbox/dark-v10',\n                center: [2.16859, 41.3954],\n                zoom: 15,\n                attributionControl: false,\n                pitch: 45,\n                hash: true\n            });\n\n            map.addControl(new mapboxgl.AttributionControl({ compact: true }));\n            map.addControl(new mapboxgl.NavigationControl());\n\n        } // final init\n    &lt;/script&gt;\n    &lt;/head&gt;\n\n    &lt;body onload=\"init()\"&gt;\n\n        &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;/body&gt;\n\n    &lt;/html&gt;\n</code></pre>"},{"location":"2.1.Funcions_doc%20copy/#paso-4-creamos-archivo-js","title":"Paso 4: Creamos archivo JS","text":"<ul> <li> <p>Dentro de nuestro directorio /geoweb/js/ creamos el archivo edificios.js, d\u00f3nde crearemos funciones especificas de nuestro proyecto  </p> </li> <li> <p>Creamos la funci\u00f3n addEdificiosCapa()</p> </li> </ul> <p>Necesitamos saber mapbox://nuestro ID i   \"source-layer\": nombre de Tileset en Mapbox Studio!!</p> <p>Para a\u00f1adir datos a nuestros mapas</p> <p>En mapbox tendremos que especificar siempre :</p> <p>map.addSource()  el tipo de dato fuente</p> <p>map.addLayer() d\u00f3nde se va a denifir como renderizar los datos</p> <p>https://docs.mapbox.com/mapbox-gl-js/style-spec/sources/ https://docs.mapbox.com/mapbox-gl-js/style-spec/layers/</p> <pre><code>  function addEdificiosCapa() {\n\n    map.addSource(\"edificios_source\", {\n        \"type\": \"vector\",\n        \"url\": \"mapbox://gismasterm2.500eaqlm\"  // mapbox://Nuestor ID Tileset\n\n    }); //fin map source\n\n\n    map.addLayer({\n    \"id\": \"edificios\",\n    \"type\": \"fill-extrusion\",\n    \"source\": \"edificios_source\",\n    \"source-layer\": \"construcciones-3f5iwq\", // Nuestro nombre Tileset\n    \"maxzoom\": 21,\n    \"minzoom\": 15,\n   // \"filter\": [\"&gt;\", \"numberOfFl\", 0],\n    \"paint\": {\n        \"fill-extrusion-color\": [\n            \"interpolate\", [\"linear\"], [\"number\", [\"get\", \"numberOfFl\"]],\n            0, \"#FFFFFF\",\n            1, \"#e6b03d\",\n            3, \"#e6b03d\",\n            6, \"#3de66d\",\n            9, \"#3de6b1\",\n            12, \"#22ecf0\",\n            15, \"#14b1fd\",\n            20, \"#3d73e6\",\n            40, \"#123a8f\",\n            80, \"#ce2f7e\",\n            100, \"transparent\"\n\n        ],\n        \"fill-extrusion-height\": [\"*\", 2, [\"to-number\", [\"get\", \"numberOfFl\"]]],\n        \"fill-extrusion-opacity\": 0.9\n    }\n}\n//,\"road-label\"\n);  \n\n} //fin funcion\n</code></pre>"},{"location":"2.1.Funcions_doc%20copy/#paso-4-llamamos-funciones-en-el-evento-load-de-map","title":"Paso 4: Llamamos funciones en el evento load de map","text":"<ul> <li> <p>Llamamos al archivo javascript js/edificios.js</p> </li> <li> <p>Llamamos a la funci\u00f3n addEdificiosCapa() dentro del evento map.on(\"load\")</p> </li> </ul> <pre><code>    &lt;html&gt;\n\n    &lt;head&gt;\n    &lt;meta charset='utf-8' /&gt;\n    &lt;title&gt;Edificios&lt;/title&gt;\n    &lt;meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' /&gt;\n    &lt;script src='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js'&gt;&lt;/script&gt;\n    &lt;link href='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css' rel='stylesheet' /&gt;\n    &lt;link href='css/estilobase.css' rel='stylesheet' /&gt;\n\n    &lt;script src='js/edificios.js'&gt;&lt;/script&gt;\n    &lt;script&gt;\n        //A\u00f1adir vuestor token y/o estilo !!\n        var map;\n        function init() {\n            mapboxgl.accessToken =\n                'pk.eyJ1IjoiZ2lzbWFzdGVybTIiLCJhIjoiY2plZHhubTQxMTNoYzMza3Rqa3kxYTdrOCJ9.53B1E6mKD_EQOVb2Y0-SsA';\n             map = new mapboxgl.Map({\n                container: 'map',\n                style: 'mapbox://styles/mapbox/dark-v10',\n                center: [2.16859, 41.3954],\n                zoom: 15,\n                attributionControl: false,\n                pitch: 45,\n                hash: true\n            });\n\n            map.addControl(new mapboxgl.AttributionControl({ compact: true }));\n            map.addControl(new mapboxgl.NavigationControl());\n\n            map.on('load', function () {\n\n                addEdificiosCapa();\n\n\n             }); //fin onload\n\n        } // final init\n    &lt;/script&gt;\n    &lt;/head&gt;\n\n    &lt;body onload=\"init()\"&gt;\n\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;/body&gt;\n\n    &lt;/html&gt;\n</code></pre> <p>visualizamos el mapa</p> <p>Descomentamos filtro y orden de capas para una mejor visualizaci\u00f3n en edificios.js \u00bfQue ha cambiado?</p> <pre><code>  function addEdificiosCapa() {\n\n    map.addSource(\"edificios_source\", {\n        \"type\": \"vector\",\n        \"url\": \"mapbox://gismasterm2.500eaqlm\"  // mapbox://Nuestor ID Tileset\n\n    }); //fin map source\n\n\n    map.addLayer({\n    \"id\": \"edificios\",\n    \"type\": \"fill-extrusion\",\n    \"source\": \"edificios_source\",\n    \"source-layer\": \"construcciones-3f5iwq\", // Nuestro nombre Tileset\n    \"maxzoom\": 21,\n    \"minzoom\": 15,\n    \"filter\": [\"&gt;\", \"numberOfFl\", 0],\n    \"paint\": {\n        \"fill-extrusion-color\": [\n            \"interpolate\", [\"linear\"], [\"number\", [\"get\", \"numberOfFl\"]],\n            0, \"#FFFFFF\",\n            1, \"#e6b03d\",\n            3, \"#e6b03d\",\n            6, \"#3de66d\",\n            9, \"#3de6b1\",\n            12, \"#22ecf0\",\n            15, \"#14b1fd\",\n            20, \"#3d73e6\",\n            40, \"#123a8f\",\n            80, \"#ce2f7e\",\n            100, \"transparent\"\n\n        ],\n        \"fill-extrusion-height\": [\"*\", 2, [\"to-number\", [\"get\", \"numberOfFl\"]]],\n        \"fill-extrusion-opacity\": 0.9\n    }\n}\n,\"road-label\"\n);  \n\n} //fin funcion\n</code></pre>"},{"location":"2.1.Funcions_doc%20copy/#paso-5-opciones-de-filtro","title":"Paso 5: Opciones de filtro","text":"<ul> <li> <p>Vamos a crear una funcionalidad para filtrar edificios seg\u00fan su n\u00famero de pisos</p> </li> <li> <p>Creamos un elementos HTML de tipo <code>input:range</code> para poder filtrar</p> </li> </ul> <p>Programamos funciones fuera del mapa!!</p> <pre><code>    &lt;html&gt;\n\n    &lt;head&gt;\n    &lt;meta charset='utf-8' /&gt;\n    &lt;title&gt;Edificios&lt;/title&gt;\n    &lt;meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' /&gt;\n    &lt;script src='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js'&gt;&lt;/script&gt;\n    &lt;link href='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css' rel='stylesheet' /&gt;\n    &lt;link href='css/estilobase.css' rel='stylesheet' /&gt;\n\n    &lt;script src='js/edificios.js'&gt;&lt;/script&gt;\n    &lt;script&gt;\n        //A\u00f1adir vuestor token y/o estilo !!\n        var map;\n        function init() {\n            mapboxgl.accessToken =\n                'pk.eyJ1IjoiZ2lzbWFzdGVybTIiLCJhIjoiY2plZHhubTQxMTNoYzMza3Rqa3kxYTdrOCJ9.53B1E6mKD_EQOVb2Y0-SsA';\n             map = new mapboxgl.Map({\n                container: 'map',\n                style: 'mapbox://styles/mapbox/dark-v10',\n                center: [2.16859, 41.3954],\n                zoom: 15,\n                attributionControl: false,\n                pitch: 45,\n                hash: true\n            });\n\n            map.addControl(new mapboxgl.AttributionControl({ compact: true }));\n            map.addControl(new mapboxgl.NavigationControl());\n\n            map.on('load', function () {\n\n                addEdificiosCapa();\n\n\n             }); //fin onload\n\n        } // final init\n    &lt;/script&gt;\n    &lt;/head&gt;\n\n    &lt;body onload=\"init()\"&gt;\n    &lt;div class=\"panelTopIzquierda\"&gt;\n\n        &lt;label id=\"altura\"&gt;M\u00e1s de 0 pisos&lt;/label&gt;\n        &lt;input id=\"slider\" type=\"range\" min=\"1\" max=\"50\" step=\"1\" value=\"0\" /&gt;\n    &lt;/div&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;/body&gt;\n\n    &lt;/html&gt;\n</code></pre> <ul> <li>A\u00f1adimos a estilobase.css las siguientes clases</li> </ul> <pre><code>.panelTopIzquierda {\n    position: absolute;\n    top: 18px;\n    left: 20px;\n    width: 200px;\n    z-index: 1000;\n    background-color: rgba(255,255,255,0.9);\n    padding: 10px;\n    font-size: 20px;\n    color: #33333;\n    border-radius: 5px;\n}\n\n.panelTopIzquierda label{\n    font-size:0.85em;\n}\n\n.panelTopIzquierda input[type=range]{\n    cursor:pointer;\n    width: 95%;\n}\n</code></pre>"},{"location":"2.1.Funcions_doc%20copy/#paso-6-funcion-de-filtro","title":"Paso 6: Funci\u00f3n de filtro","text":"<ul> <li>A\u00f1adimos a  edificios.js la funcion filtrarEdificios()</li> </ul> <pre><code>    function filtrarEdificios(valor) {\n        map.setFilter(\"edificios\", [\"&gt;\", \"numberOfFl\", parseInt(valor)]);\n\n        document.getElementById(\"altura\").innerHTML = \"M\u00e1s de  &lt;b&gt;\" + valor + \"&lt;/b&gt; pisos\";\n\n    }\n</code></pre>"},{"location":"2.1.Funcions_doc%20copy/#paso-7-evento-onchange","title":"Paso 7: Evento onChange","text":"<ul> <li>LLamamos a la funci\u00f3n de desde el evento <code>onChange</code> del objeto input de HTML</li> </ul> <pre><code>    &lt;html&gt;\n\n    &lt;head&gt;\n    &lt;meta charset='utf-8' /&gt;\n    &lt;title&gt;Edificios&lt;/title&gt;\n    &lt;meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' /&gt;\n    &lt;script src='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js'&gt;&lt;/script&gt;\n    &lt;link href='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css' rel='stylesheet' /&gt;\n    &lt;link href='css/estilobase.css' rel='stylesheet' /&gt;\n    &lt;script src='js/utils.js'&gt;&lt;/script&gt;\n    &lt;script src='js/edificios.js'&gt;&lt;/script&gt;\n    &lt;script&gt;\n        //A\u00f1adir vuestor token y/o estilo !!\n        var map;\n        function init() {\n            mapboxgl.accessToken =\n                'pk.eyJ1IjoiZ2lzbWFzdGVybTIiLCJhIjoiY2plZHhubTQxMTNoYzMza3Rqa3kxYTdrOCJ9.53B1E6mKD_EQOVb2Y0-SsA';\n             map = new mapboxgl.Map({\n                container: 'map',\n                style: 'mapbox://styles/mapbox/dark-v10',\n                center: [2.16859, 41.3954],\n                zoom: 15,\n                attributionControl: false,\n                pitch: 45,\n                hash: true\n            });\n\n            map.addControl(new mapboxgl.AttributionControl({ compact: true }));\n            map.addControl(new mapboxgl.NavigationControl());\n\n            map.on('load', function () {\n\n                addEdificiosCapa();\n\n                addPopupToMap(\"edificios\");\n             }); //fin onload\n\n        } // final init\n    &lt;/script&gt;\n    &lt;/head&gt;\n\n    &lt;body onload=\"init()\"&gt;\n    &lt;div class=\"panelTopIzquierda\"&gt;\n\n       &lt;label id=\"altura\"&gt;M\u00e1s de 0 pisos&lt;/label&gt;\n        &lt;input  onChange=\"filtrarEdificios(this.value)\" id=\"slider\" type=\"range\" min=\"1\" max=\"50\" step=\"1\" value=\"0\" /&gt;\n    &lt;/div&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;/body&gt;\n\n    &lt;/html&gt;\n</code></pre>"},{"location":"2.1.Funcions_doc%20copy/#paso-8-eventos-click-i-popup","title":"Paso 8: Eventos Click i popup","text":"<p>Nuevas posibilidades de mapbox</p> <p>https://docs.mapbox.com/mapbox-gl-js/api/map/#map.event:click</p> <p>https://docs.mapbox.com/mapbox-gl-js/api/markers/#popup</p> <p>A\u00f1adir funcion Popup personalizado dentro de edificios.js</p> <pre><code>function addPopupToMapEdificios(nombreCapa) {\n\n    map.on('click', nombreCapa, function (e) {\n\n        var text = \"\";\n        //console.info(e);\n        for (key in e.features[0].properties) {\n\n            if (key == \"numberOfFl\") {\n                text += \"&lt;b&gt;Numero de plantas&lt;/b&gt;:\" + e.features[0].properties[key] + \"&lt;br&gt;\";\n            }\n            if (key == \"localId\") {\n                //localId 0004702DF3800C_part1\n                //http://ovc.catastro.meh.es/OVCServWeb/OVCWcfLibres/OVCFotoFachada.svc/RecuperarFotoFachadaGet?ReferenciaCatastral=0004701DF3800C\n                //https://www1.sedecatastro.gob.es/CYCBienInmueble/OVCListaBienes.aspx?rc1=0004701&amp;rc2=DF3800C\n\n                var localId = e.features[0].properties[key];\n\n                var localIdSplit = localId.split(\"_\"); // 0004702DF3800C  part1\n                var parte1 = localIdSplit[0].substring(0, 7);\n                var parte2 = localIdSplit[0].substring(7, localIdSplit[0].length);\n                text += \"&lt;img width=200 src=http://ovc.catastro.meh.es/OVCServWeb/OVCWcfLibres/OVCFotoFachada.svc/RecuperarFotoFachadaGet?ReferenciaCatastral=\" + localId + \"&gt;&lt;br&gt;\";\n                text += \"&lt;a target=blank href=https://www1.sedecatastro.gob.es/CYCBienInmueble/OVCListaBienes.aspx?rc1=\" + parte1 + \"&amp;rc2=\" + parte2 + \"&gt;Ficha&lt;/a&gt;&lt;br&gt;\";\n\n            }\n\n\n        }\n        new mapboxgl.Popup()\n            .setLngLat(e.lngLat)\n            .setHTML(text)\n            .addTo(map);\n\n    });\n\n    map.on('mouseenter', nombreCapa, function () {\n        map.getCanvas().style.cursor = 'pointer';\n    });\n\n    map.on('mouseleave', nombreCapa, function () {\n        map.getCanvas().style.cursor = '';\n    });\n\n}\n</code></pre>"},{"location":"2.1.Funcions_doc%20copy/#paso-9-llamamos-funcion-addpopuptomapedificios","title":"Paso 9: Llamamos funci\u00f3n addPopupToMapEdificios","text":"<ul> <li>LLamamos a la funci\u00f3n de desde el evento <code>load</code> del mapa</li> </ul> <pre><code>    &lt;html&gt;\n\n    &lt;head&gt;\n    &lt;meta charset='utf-8' /&gt;\n    &lt;title&gt;Edificios&lt;/title&gt;\n    &lt;meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' /&gt;\n    &lt;script src='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js'&gt;&lt;/script&gt;\n    &lt;link href='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css' rel='stylesheet' /&gt;\n    &lt;link href='css/estilobase.css' rel='stylesheet' /&gt;\n    &lt;script src='js/utils.js'&gt;&lt;/script&gt;\n    &lt;script src='js/edificios.js'&gt;&lt;/script&gt;\n    &lt;script&gt;\n        //A\u00f1adir vuestor token y/o estilo !!\n        var map;\n        function init() {\n            mapboxgl.accessToken =\n                'pk.eyJ1IjoiZ2lzbWFzdGVybTIiLCJhIjoiY2plZHhubTQxMTNoYzMza3Rqa3kxYTdrOCJ9.53B1E6mKD_EQOVb2Y0-SsA';\n             map = new mapboxgl.Map({\n                container: 'map',\n                style: 'mapbox://styles/mapbox/dark-v10',\n                center: [2.16859, 41.3954],\n                zoom: 15,\n                attributionControl: false,\n                pitch: 45,\n                hash: true\n            });\n\n            map.addControl(new mapboxgl.AttributionControl({ compact: true }));\n            map.addControl(new mapboxgl.NavigationControl());\n\n            map.on('load', function () {\n\n                addEdificiosCapa();\n\n                addPopupToMapEdificios(\"edificios\");\n             }); //fin onload\n\n        } // final init\n    &lt;/script&gt;\n    &lt;/head&gt;\n\n    &lt;body onload=\"init()\"&gt;\n    &lt;div class=\"panelTopIzquierda\"&gt;\n\n       &lt;label id=\"altura\"&gt;M\u00e1s de 0 pisos&lt;/label&gt;\n        &lt;input  onChange=\"filtrarEdificios(this.value)\" id=\"slider\" type=\"range\" min=\"1\" max=\"50\" step=\"1\" value=\"0\" /&gt;\n    &lt;/div&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;/body&gt;\n\n    &lt;/html&gt;\n</code></pre> <p>Visualizamos mapa</p> <p></p> <p>Geocodificador Mapbox GL  https://github.com/mapbox/mapbox-gl-geocoder/blob/master/API.md</p> <pre><code>    &lt;html&gt;\n\n    &lt;head&gt;\n    &lt;meta charset='utf-8' /&gt;\n    &lt;title&gt;Edificios&lt;/title&gt;\n    &lt;meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' /&gt;\n    &lt;script src='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js'&gt;&lt;/script&gt;\n    &lt;link href='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css' rel='stylesheet' /&gt;\n   &lt;script src=\"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.min.js\"&gt;&lt;/script&gt;\n&lt;link rel=\"stylesheet\" href=\"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.css\" type=\"text/css\"&gt;\n    &lt;link href='css/estilobase.css' rel='stylesheet' /&gt;\n\n    &lt;script src='js/edificios.js'&gt;&lt;/script&gt;\n    &lt;script&gt;\n        //A\u00f1adir vuestor token y/o estilo !!\n        var map;\n        function init() {\n            mapboxgl.accessToken =\n                'pk.eyJ1IjoiZ2lzbWFzdGVybTIiLCJhIjoiY2plZHhubTQxMTNoYzMza3Rqa3kxYTdrOCJ9.53B1E6mKD_EQOVb2Y0-SsA';\n             map = new mapboxgl.Map({\n                container: 'map',\n                style: 'mapbox://styles/mapbox/dark-v10',\n                center: [2.16859, 41.3954],\n                zoom: 15,\n                attributionControl: false,\n                pitch: 45,\n                hash: true\n            });\n\n            map.addControl(new mapboxgl.AttributionControl({ compact: true }));\n            map.addControl(new mapboxgl.NavigationControl());\n\n            map.addControl(\n                new MapboxGeocoder({\n                accessToken: mapboxgl.accessToken,\n                mapboxgl: mapboxgl\n                }));\n\n            map.on('load', function () {\n\n                addEdificiosCapa();\n\n                addPopupToMapEdificios(\"edificios\");\n             }); //fin onload\n\n        } // final init\n    &lt;/script&gt;\n    &lt;/head&gt;\n\n    &lt;body onload=\"init()\"&gt;\n   &lt;div class=\"panelTopIzquierda\"&gt;\n\n       &lt;label id=\"altura\"&gt;M\u00e1s de 0 pisos&lt;/label&gt;\n        &lt;input  onChange=\"filtrarEdificios(this.value)\" id=\"slider\" type=\"range\" min=\"1\" max=\"50\" step=\"1\" value=\"0\" /&gt;\n    &lt;/div&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;/body&gt;\n\n    &lt;/html&gt;\n</code></pre> <p>Miramos opciones de Geocoder. \u00bfLimit\u00e1mos b\u00fasquedas del geocoder por caja de coordenadas de Barcelona?</p> <p>https://github.com/mapbox/mapbox-gl-geocoder/blob/main/API.md</p> <p><code>bbox:[2.1066 , 41.3000 , 2.2536 , 41.4468]</code></p> <p>\u00bfPonemos t\u00edtulo?</p> <p>\u00bfEditamos index.html y subimos el ejemplo al GitHub?</p> <pre><code>    git pull\n    git add .\n    git commit -m \"visor catastro\"\n    git push\n</code></pre>"},{"location":"2.1.Funcions_doc%20copy/#saber-mas","title":"Saber m\u00e1s..","text":"<p>Forma reactiva de hacer lo mismo en el evento onchange</p> <pre><code> document.getElementById(\"slider\").onchange = function() {\n\n                filtrarEdificios(this.value)\n            }\n</code></pre> <p>Activar/ desactivar capa via c\u00f3digo</p> <pre><code>    map.setLayoutProperty(\"edificios\", \"visibility\", \"visible\");\n    map.setLayoutProperty(\"edificios\", \"visibility\", \"none\");\n</code></pre> <p>desactivar capas cuyo id contenga 'label'</p> <pre><code>            for (var i=0; i &lt; map.getStyle().layers.length;i++){\n\n                    if(map.getStyle().layers[i].id.indexOf(\"label\")!=-1){\n\n                        map.setLayoutProperty(map.getStyle().layers[i].id, \"visibility\", \"none\");\n                    }\n\n                }\n</code></pre>"},{"location":"2.1.Funcions_doc%20copy/#nivel-avanzado","title":"Nivel avanzado..","text":"<ul> <li>Podemos programas el evento click sobre el mapa y no sobre una capa conresta, obtener los vectores de todas las capas y filtrar por la capa que nos interesa.</li> <li>La funci\u00f3n addPopupToMapEdificios quedaria as\u00ed y funcionaria en 2d c\u00f3mo en 3d</li> </ul> <pre><code>    function addPopupToMapEdificios(nombreCapa) {\n\n    map.on('click', function (e) {\n\n        var text = \"\";\n        var bbox = [[e.point.x - 10, e.point.y - 10], [e.point.x + 10, e.point.y + 10]];\n        var features = map.queryRenderedFeatures(bbox, { layers: [nombreCapa] });\n\n        if (features.length &gt; 0) {\n            for (key in features[0].properties) {\n\n                if (key == \"numberOfFl\") {\n                    text += \"&lt;b&gt;Numero de plantas&lt;/b&gt;:\" + features[0].properties[key] + \"&lt;br&gt;\";\n                }\n                if (key == \"localId\") {\n                    //localId 0004702DF3800C_part1\n                    //http://ovc.catastro.meh.es/OVCServWeb/OVCWcfLibres/OVCFotoFachada.svc/RecuperarFotoFachadaGet?ReferenciaCatastral=0004701DF3800C\n                    //https://www1.sedecatastro.gob.es/CYCBienInmueble/OVCListaBienes.aspx?rc1=0004701&amp;rc2=DF3800C\n\n                    var localId = features[0].properties[key];\n\n                    var localIdSplit = localId.split(\"_\"); // 0004702DF3800C  part1\n                    var parte1 = localIdSplit[0].substring(0, 7);\n                    var parte2 = localIdSplit[0].substring(7, localIdSplit[0].length);\n                    text += \"&lt;img width=200 src=http://ovc.catastro.meh.es/OVCServWeb/OVCWcfLibres/OVCFotoFachada.svc/RecuperarFotoFachadaGet?ReferenciaCatastral=\" + localId + \"&gt;&lt;br&gt;\";\n                    text += \"&lt;a target=blank href=https://www1.sedecatastro.gob.es/CYCBienInmueble/OVCListaBienes.aspx?rc1=\" + parte1 + \"&amp;rc2=\" + parte2 + \"&gt;Ficha&lt;/a&gt;&lt;br&gt;\";\n\n                }\n\n\n            }\n            new mapboxgl.Popup()\n                .setLngLat(e.lngLat)\n                .setHTML(text)\n                .addTo(map);\n        }\n\n    });\n\n    map.on('mouseenter', nombreCapa, function () {\n        map.getCanvas().style.cursor = 'pointer';\n    });\n\n    map.on('mouseleave', nombreCapa, function () {\n        map.getCanvas().style.cursor = '';\n    });\n\n}\n</code></pre>"},{"location":"3.1.Funcions_doc/","title":"3.1.Funcions","text":""},{"location":"3.1.Funcions_doc/#functions","title":"Functions","text":"on(type, func) <p>Adds an event listener to the map.</p> getSource(source) <p>Retrieves the specified source from the map.</p> addSource(source) <p>Adds a source to the map.</p> getLayer(layerId) <p>Retrieves the layer with the specified ID from the map.</p> jumpTo(options) <p>Jumps to the specified coordinates and zoom on the map.</p> setLayoutProperty(object) <p>Sets layout property for a layer on the map.</p> addControl(control) <p>Adds a control to the map.</p> getZoom() \u0393\u00e7\u00c6 <code>number</code> <p>Retrieves the current zoom level of the map.</p> addMouseCoordControl() <p>Adds a mouse coordinate control to the map.</p> addGeolocateControl(options) <p>Adds a geolocate control to the map.</p> getBounds() <p>Retrieves the bounds of the map.</p> getCanvas() <p>Retrieves the canvas of the map.</p> setCenter(coordinates) <p>Sets the center of the map to the provided coordinates.</p> addLayer(layer) <p>Adds a layer to the map.</p> addLayerGeoJSON(layer) <p>Adds a GeoJSON layer to the map.</p> addLayerGeoJSON(layer) <p>Adds a GeoJSON layer to the map.</p> addLayerWMS(layer) <p>Adds a WMS layer to the map.</p> removeLayer(layerId) <p>Removes a layer from the map.</p> removeSource(layerId) <p>Removes a source from the map.</p> addLogo(options) <p>Adds a logo to the map.</p> addLogo(options) <p>Adds a logo to the map.</p> addBasemaps(baseLayers) <p>Adds base layers to the map.</p> addExportControl() <p>Adds an export control to the map.</p> addMarker(options) \u0393\u00e7\u00c6 <code>Object</code> <p>Adds a marker to the map.</p> addMarker(options) \u0393\u00e7\u00c6 <code>Object</code> <p>Adds a marker to the map.</p> addPopup(options) \u0393\u00e7\u00c6 <code>Object</code> <p>Adds a popup to the map.</p> addFullScreen() <p>Adds a fullscreen control to the map.</p> addLayerTree(options) <p>Adds a layer tree to the map.</p> createNavigationControl(options) \u0393\u00e7\u00c6 <code>Object</code> <p>Creates a navigation control with the provided options.</p> createNavigationControl(options) \u0393\u00e7\u00c6 <code>Object</code> <p>Creates a navigation control with the provided options.</p> addNavigationControl(options) <p>Adds a navigation control to the map with the provided options.</p> addAttributionControl(options) <p>Adds an attribution control to the map with the provided options.</p> _dealStyleMaps(name) \u0393\u00e7\u00c6 <code>string</code> <p>Internal method to handle map styles.</p> addImageLayerICGC(name, year) <p>Adds an ICGC image layer to the map based on the specified name and year.</p> addVectorLayerICGC(name, year) <p>Adds an ICGC vector layer to the map based on the specified name and year.</p> addTerrain(resolution) <p>Adds 3D terrain to the map using hillshade.</p> <p></p>"},{"location":"3.1.Funcions_doc/#ontype-func","title":"on(type, func)","text":"<p>Adds an event listener to the map.</p> <p>Kind: global function  </p> Param Type Description type <code>string</code> The type of the event. func <code>function</code> The callback function to be executed when the event occurs. <p></p>"},{"location":"3.1.Funcions_doc/#getsourcesource","title":"getSource(source)","text":"<p>Retrieves the specified source from the map.</p> <p>Kind: global function  </p> Param Type Description source <code>string</code> The ID of the source to retrieve. <p></p>"},{"location":"3.1.Funcions_doc/#addsourcesource","title":"addSource(source)","text":"<p>Adds a source to the map.</p> <p>Kind: global function  </p> Param Type Description source <code>string</code> The ID of the source to add. <p></p>"},{"location":"3.1.Funcions_doc/#getlayerlayerid","title":"getLayer(layerId)","text":"<p>Retrieves the layer with the specified ID from the map.</p> <p>Kind: global function  </p> Param Type Description layerId <code>string</code> The ID of the layer to retrieve. <p></p>"},{"location":"3.1.Funcions_doc/#jumptooptions","title":"jumpTo(options)","text":"<p>Jumps to the specified coordinates and zoom on the map.</p> <p>Kind: global function  </p> Param Type Description options <code>Object</code> Coordinates and options to jump to: { center: [coordx, coordy], zoom: zoom, essential: true }. <p></p>"},{"location":"3.1.Funcions_doc/#setlayoutpropertyobject","title":"setLayoutProperty(object)","text":"<p>Sets layout property for a layer on the map.</p> <p>Kind: global function  </p> Param Type Description object <code>Object</code> Object containing layer ID and property to set. <p></p>"},{"location":"3.1.Funcions_doc/#addcontrolcontrol","title":"addControl(control)","text":"<p>Adds a control to the map.</p> <p>Kind: global function  </p> Param Type Description control <code>Object</code> The control to add. <p></p>"},{"location":"3.1.Funcions_doc/#getzoom-c-number","title":"getZoom() \u0393\u00e7\u00c6 <code>number</code>","text":"<p>Retrieves the current zoom level of the map.</p> <p>Kind: global function Returns: <code>number</code> - - The current zoom level. </p>"},{"location":"3.1.Funcions_doc/#addmousecoordcontrol","title":"addMouseCoordControl()","text":"<p>Adds a mouse coordinate control to the map.</p> <p>Kind: global function </p>"},{"location":"3.1.Funcions_doc/#addgeolocatecontroloptions","title":"addGeolocateControl(options)","text":"<p>Adds a geolocate control to the map.</p> <p>Kind: global function  </p> Param Type Description options <code>Object</code> Options for the geolocate control. <p></p>"},{"location":"3.1.Funcions_doc/#getbounds","title":"getBounds()","text":"<p>Retrieves the bounds of the map.</p> <p>Kind: global function </p>"},{"location":"3.1.Funcions_doc/#getcanvas","title":"getCanvas()","text":"<p>Retrieves the canvas of the map.</p> <p>Kind: global function </p>"},{"location":"3.1.Funcions_doc/#setcentercoordinates","title":"setCenter(coordinates)","text":"<p>Sets the center of the map to the provided coordinates.</p> <p>Kind: global function  </p> Param Type Description coordinates <code>Array</code> Coordinates to center the map: [1.3119, 41.489] <p></p>"},{"location":"3.1.Funcions_doc/#addlayerlayer","title":"addLayer(layer)","text":"<p>Adds a layer to the map.</p> <p>Kind: global function  </p> Param Type Description layer <code>Object</code> Options for the layer to add. <p></p>"},{"location":"3.1.Funcions_doc/#addlayergeojsonlayer","title":"addLayerGeoJSON(layer)","text":"<p>Adds a GeoJSON layer to the map.</p> <p>Kind: global function  </p> Param Type Description layer <code>Object</code> Options for the GeoJSON layer to add. layer.id <code>string</code> Unique identifier for the layer. layer.type <code>string</code> Type of layer ('geojson'). layer.data <code>Object</code> GeoJSON data for the layer. layer.layerType <code>string</code> Map layer type (e.g., 'symbol', 'circle', 'fill'). layer.layout <code>Object</code> Layer layout configuration. layer.paint <code>Object</code> Layer paint configuration. <p></p>"},{"location":"3.1.Funcions_doc/#addlayergeojsonlayer_1","title":"addLayerGeoJSON(layer)","text":"<p>Adds a GeoJSON layer to the map.</p> <p>Kind: global function  </p> Param Type Description layer <code>Object</code> Options for the GeoJSON layer to add. layer.id <code>string</code> Unique identifier for the layer. layer.type <code>string</code> Type of layer ('geojson'). layer.data <code>Object</code> GeoJSON data for the layer. layer.layerType <code>string</code> Map layer type (e.g., 'symbol', 'circle', 'fill'). layer.layout <code>Object</code> Layer layout configuration. layer.paint <code>Object</code> Layer paint configuration. <p></p>"},{"location":"3.1.Funcions_doc/#addlayerwmslayer","title":"addLayerWMS(layer)","text":"<p>Adds a WMS layer to the map.</p> <p>Kind: global function  </p> Param Type Description layer <code>Object</code> Options for the WMS layer to add. layer.id <code>string</code> Unique identifier for the layer. layer.type <code>string</code> Type of layer ('raster'). layer.tiles <code>Array.&lt;string&gt;</code> Tiles for the raster layer. <p></p>"},{"location":"3.1.Funcions_doc/#removelayerlayerid","title":"removeLayer(layerId)","text":"<p>Removes a layer from the map.</p> <p>Kind: global function  </p> Param Type Description layerId <code>string</code> Identifier of the layer to remove. <p></p>"},{"location":"3.1.Funcions_doc/#removesourcelayerid","title":"removeSource(layerId)","text":"<p>Removes a source from the map.</p> <p>Kind: global function  </p> Param Type Description layerId <code>string</code> Identifier of the source to remove. <p></p>"},{"location":"3.1.Funcions_doc/#addlogooptions","title":"addLogo(options)","text":"<p>Adds a logo to the map.</p> <p>Kind: global function  </p> Param Type Description options <code>Object</code> Options for the logo to add. options.id <code>string</code> Unique identifier for the logo. options.url <code>string</code> URL of the logo image. options.href <code>string</code> URL to navigate to when the logo is clicked. <p></p>"},{"location":"3.1.Funcions_doc/#addlogooptions_1","title":"addLogo(options)","text":"<p>Adds a logo to the map.</p> <p>Kind: global function  </p> Param Type Description options <code>Object</code> Options for the logo to add. options.id <code>string</code> Unique identifier for the logo. options.url <code>string</code> URL of the logo image. options.href <code>string</code> URL to navigate to when the logo is clicked. <p></p>"},{"location":"3.1.Funcions_doc/#addbasemapsbaselayers","title":"addBasemaps(baseLayers)","text":"<p>Adds base layers to the map.</p> <p>Kind: global function  </p> Param Type Description baseLayers <code>Array.&lt;Object&gt;</code> Array of base layer objects. baseLayers.label <code>string</code> Label for the base layer. baseLayers.image <code>string</code> URL of the image representing the base layer. baseLayers.url <code>string</code> URL of the base layer style. <p></p>"},{"location":"3.1.Funcions_doc/#addexportcontrol","title":"addExportControl()","text":"<p>Adds an export control to the map.</p> <p>Kind: global function </p>"},{"location":"3.1.Funcions_doc/#addmarkeroptions-c-object","title":"addMarker(options) \u0393\u00e7\u00c6 <code>Object</code>","text":"<p>Adds a marker to the map.</p> <p>Kind: global function Returns: <code>Object</code> - - Instance of the added marker.  </p> Param Type Description options <code>Object</code> Options for the marker to add. options.text <code>string</code> Text content for the marker popup. options.options <code>Object</code> Marker options. options.coord <code>LngLatLike</code> Coordinates for placing the marker. options.textOffset <code>Object</code> Text offset for the marker popup. <p></p>"},{"location":"3.1.Funcions_doc/#addmarkeroptions-c-object_1","title":"addMarker(options) \u0393\u00e7\u00c6 <code>Object</code>","text":"<p>Adds a marker to the map.</p> <p>Kind: global function Returns: <code>Object</code> - - Instance of the added marker.  </p> Param Type Description options <code>Object</code> Options for the marker to add. options.text <code>string</code> Text content for the marker popup. options.options <code>Object</code> Marker options. options.coord <code>LngLatLike</code> Coordinates for placing the marker. options.textOffset <code>Object</code> Text offset for the marker popup. <p></p>"},{"location":"3.1.Funcions_doc/#addpopupoptions-c-object","title":"addPopup(options) \u0393\u00e7\u00c6 <code>Object</code>","text":"<p>Adds a popup to the map.</p> <p>Kind: global function Returns: <code>Object</code> - - Instance of the added popup.  </p> Param Type Description options <code>Object</code> Options for the popup to add. options.coord <code>LngLatLike</code> Coordinates for placing the popup. options.text <code>string</code> HTML content for the popup. <p></p>"},{"location":"3.1.Funcions_doc/#addfullscreen","title":"addFullScreen()","text":"<p>Adds a fullscreen control to the map.</p> <p>Kind: global function </p>"},{"location":"3.1.Funcions_doc/#addlayertreeoptions","title":"addLayerTree(options)","text":"<p>Adds a layer tree to the map.</p> <p>Kind: global function  </p> Param Type Description options <code>Object</code> Options for the layer tree to add. options.features <code>Object</code> Features for the layer tree. options.id <code>string</code> Unique identifier for the layer tree. options.type <code>string</code> Type of layer tree ('geojson', 'raster', etc.). <p></p>"},{"location":"3.1.Funcions_doc/#createnavigationcontroloptions-c-object","title":"createNavigationControl(options) \u0393\u00e7\u00c6 <code>Object</code>","text":"<p>Creates a navigation control with the provided options.</p> <p>Kind: global function Returns: <code>Object</code> - - Instance of the created navigation control.  </p> Param Type Description options <code>Object</code> Options for the navigation control. <p></p>"},{"location":"3.1.Funcions_doc/#createnavigationcontroloptions-c-object_1","title":"createNavigationControl(options) \u0393\u00e7\u00c6 <code>Object</code>","text":"<p>Creates a navigation control with the provided options.</p> <p>Kind: global function Returns: <code>Object</code> - - Instance of the created navigation control.  </p> Param Type Description options <code>Object</code> Options for the navigation control. <p></p>"},{"location":"3.1.Funcions_doc/#addnavigationcontroloptions","title":"addNavigationControl(options)","text":"<p>Adds a navigation control to the map with the provided options.</p> <p>Kind: global function  </p> Param Type Description options <code>Object</code> Options for the navigation control. <p></p>"},{"location":"3.1.Funcions_doc/#addattributioncontroloptions","title":"addAttributionControl(options)","text":"<p>Adds an attribution control to the map with the provided options.</p> <p>Kind: global function  </p> Param Type Description options <code>Object</code> Options for the attribution control. <p></p>"},{"location":"3.1.Funcions_doc/#_dealstylemapsname-c-string","title":"_dealStyleMaps(name) \u0393\u00e7\u00c6 <code>string</code>","text":"<p>Internal method to handle map styles.</p> <p>Kind: global function Returns: <code>string</code> - - URL of the map style.  </p> Param Type Description name <code>string</code> Name of the map style. <p></p>"},{"location":"3.1.Funcions_doc/#addimagelayericgcname-year","title":"addImageLayerICGC(name, year)","text":"<p>Adds an ICGC image layer to the map based on the specified name and year.</p> <p>Kind: global function  </p> Param Type Description name <code>string</code> The name of the layer. Mandatory. options: 'orto', 'geo', 'slope', 'dem', 'relleu', etc. year <code>string</code> The year of the image layer (optional, applicable only for certain layers like 'orto'). <p></p>"},{"location":"3.1.Funcions_doc/#addvectorlayericgcname-year","title":"addVectorLayerICGC(name, year)","text":"<p>Adds an ICGC vector layer to the map based on the specified name and year.</p> <p>Kind: global function  </p> Param Type Description name <code>string</code> The name of the vector layer. year <code>string</code> The year associated with the vector layer (optional). <p></p>"},{"location":"3.1.Funcions_doc/#addterrainresolution","title":"addTerrain(resolution)","text":"<p>Adds 3D terrain to the map using hillshade.</p> <p>Kind: global function  </p> Param Type Description resolution <code>string</code> resolution of the terrain data: 2m or 5m."},{"location":"faq/","title":"Preguntes Freq\u00fcents","text":""},{"location":"faq/#descripcion","title":"Descripci\u00f3n","text":"<p>Nos han encargado realizar un mapa para visualizar edificios de Barcelona</p> <ul> <li> <p>Sabemos que la direccion Direccion General de Catastro ofrece servicio de descarga de edificios</p> <p>http://www.catastro.minhap.es/webinspire/index.html</p> </li> <li> <p>Sabemos tambi\u00e9n que existe un plugin de QGIS para hacer una descarga m\u00e1s f\u00e1cil el \"Spanish Inspire Catastral Downloader\"</p> </li> <li> <p>Mapbox.com nos ofrece opciones como servidor para hospedar y convertir datos a Vector-Tiles</p> </li> <li> <p>Mapbox tiene un estio mundial oscuro que tambi\u00e9n nos puede servir como fondo</p> <p>mapbox://styles/mapbox/dark-v10 </p> </li> <li> <p>En la specificaci\u00f3n de Style de Mapbox los pol\u00edgonos  tienen la propiedad \"paint\" \"fill-extrusion\" d\u00f3nde que puedo cambiar de color y extrudir geometrias por un valor de altura</p> <p>https://docs.mapbox.com/mapbox-gl-js/style-spec/#layers-fill-extrusion </p> </li> </ul>"},{"location":"faq/#paso-1-preparamos-datos","title":"Paso 1: Preparamos datos","text":"<p>Descargamos archivo ya convertido contrucciones.zip</p> <p>No guarde\u00eds el archivo dentro de /geoweb</p> <p>Si quisieramos preparar los datos o descargar otro municipio</p> <pre><code>* Podr\u00edamos descargar todas las construcciones de Barcelona (321 mil pol\u00edgonos) directamente de la Direccion General de Catastro [http://www.catastro.minhap.es/webinspire/index.html](http://www.catastro.minhap.es/webinspire/index.html){target=_blank}\n\n* Descargar\u00edamos los  datos [http://www.catastro.minhap.es/INSPIRE/Buildings/08/08900-BARCELONA/A.ES.SDGC.BU.08900.zip](http://www.catastro.minhap.es/INSPIRE/Buildings/08/08900-BARCELONA/A.ES.SDGC.BU.08900.zip) o utilizar\u00edamos QGIS + complemento \"Spanish Inspire Catastral Downloader\"\n\n* Convertir\u00edamos el archivo **A.ES.SDGC.BU.08900.buildingpart.gml** a SHP  \"contrucciones.shp\" con QGIS (coordenadas lat/lon EPSG:4326)\n</code></pre>"},{"location":"faq/#paso-2entramos-en-mapbboxcom-i-cargamos-los-datos","title":"Paso 2:Entramos en MapbBox.com i cargamos los datos","text":"<ul> <li> <p>Lo cargamos como Tileset dentro de MapBox, a\u00f1adimos contrucciones.zip SIN DESCOMPRIMIR</p> </li> <li> <p>Entramos en MapBox.com <code>Studio</code> --&gt; <code>Tilesets</code> --&gt;<code>New tileset</code> Arrastramos contrucciones.zip*</p> </li> <li> <p>Copiamos ID y nombre de la capa</p> </li> </ul> <p></p>"},{"location":"faq/#paso-3crear-edificioshtml","title":"Paso 3:Crear edificios.html","text":"<p>En este ejemplo y en adelante vamos a reutilizar el archivo css /geoweb/css/estilobase.css\" que existe ya en nuestro proyecto</p> <p>El archivo estilobase.css es este</p> <p><pre><code>            body {\n                margin: 0;\n            }\n\n            #map {\n                height: 100%;\n                width: 100%;\n                background-color: #ffffff\n            }\n</code></pre> * Vamos a VSCode y creamos el archivo edificios.html dentro de /geoweb</p> <pre><code>    &lt;html&gt;\n    &lt;head&gt;\n    &lt;meta charset='utf-8' /&gt;\n    &lt;title&gt;Edificios&lt;/title&gt;\n    &lt;meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' /&gt;\n    &lt;script src='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js'&gt;&lt;/script&gt;\n    &lt;link href='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css' rel='stylesheet' /&gt;\n    &lt;link href='css/estilobase.css' rel='stylesheet' /&gt;\n\n\n    &lt;script&gt;\n        //A\u00f1adir vuestor token y/o estilo !!\n        var map;\n        function init() {\n            mapboxgl.accessToken =\n                'pk.eyJ1IjoiZ2lzbWFzdGVybTIiLCJhIjoiY2plZHhubTQxMTNoYzMza3Rqa3kxYTdrOCJ9.53B1E6mKD_EQOVb2Y0-SsA';\n             map = new mapboxgl.Map({\n                container: 'map',\n                style: 'mapbox://styles/mapbox/dark-v10',\n                center: [2.16859, 41.3954],\n                zoom: 15,\n                attributionControl: false,\n                pitch: 45,\n                hash: true\n            });\n\n            map.addControl(new mapboxgl.AttributionControl({ compact: true }));\n            map.addControl(new mapboxgl.NavigationControl());\n\n        } // final init\n    &lt;/script&gt;\n    &lt;/head&gt;\n\n    &lt;body onload=\"init()\"&gt;\n\n        &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;/body&gt;\n\n    &lt;/html&gt;\n</code></pre>"},{"location":"faq/#paso-4-creamos-archivo-js","title":"Paso 4: Creamos archivo JS","text":"<ul> <li> <p>Dentro de nuestro directorio /geoweb/js/ creamos el archivo edificios.js, d\u00f3nde crearemos funciones especificas de nuestro proyecto  </p> </li> <li> <p>Creamos la funci\u00f3n addEdificiosCapa()</p> </li> </ul> <p>Necesitamos saber mapbox://nuestro ID i   \"source-layer\": nombre de Tileset en Mapbox Studio!!</p> <p>Para a\u00f1adir datos a nuestros mapas</p> <p>En mapbox tendremos que especificar siempre :</p> <p>map.addSource()  el tipo de dato fuente</p> <p>map.addLayer() d\u00f3nde se va a denifir como renderizar los datos</p> <p>https://docs.mapbox.com/mapbox-gl-js/style-spec/sources/ https://docs.mapbox.com/mapbox-gl-js/style-spec/layers/</p> <pre><code>  function addEdificiosCapa() {\n\n    map.addSource(\"edificios_source\", {\n        \"type\": \"vector\",\n        \"url\": \"mapbox://gismasterm2.500eaqlm\"  // mapbox://Nuestor ID Tileset\n\n    }); //fin map source\n\n\n    map.addLayer({\n    \"id\": \"edificios\",\n    \"type\": \"fill-extrusion\",\n    \"source\": \"edificios_source\",\n    \"source-layer\": \"construcciones-3f5iwq\", // Nuestro nombre Tileset\n    \"maxzoom\": 21,\n    \"minzoom\": 15,\n   // \"filter\": [\"&gt;\", \"numberOfFl\", 0],\n    \"paint\": {\n        \"fill-extrusion-color\": [\n            \"interpolate\", [\"linear\"], [\"number\", [\"get\", \"numberOfFl\"]],\n            0, \"#FFFFFF\",\n            1, \"#e6b03d\",\n            3, \"#e6b03d\",\n            6, \"#3de66d\",\n            9, \"#3de6b1\",\n            12, \"#22ecf0\",\n            15, \"#14b1fd\",\n            20, \"#3d73e6\",\n            40, \"#123a8f\",\n            80, \"#ce2f7e\",\n            100, \"transparent\"\n\n        ],\n        \"fill-extrusion-height\": [\"*\", 2, [\"to-number\", [\"get\", \"numberOfFl\"]]],\n        \"fill-extrusion-opacity\": 0.9\n    }\n}\n//,\"road-label\"\n);  \n\n} //fin funcion\n</code></pre>"},{"location":"faq/#paso-4-llamamos-funciones-en-el-evento-load-de-map","title":"Paso 4: Llamamos funciones en el evento load de map","text":"<ul> <li> <p>Llamamos al archivo javascript js/edificios.js</p> </li> <li> <p>Llamamos a la funci\u00f3n addEdificiosCapa() dentro del evento map.on(\"load\")</p> </li> </ul> <pre><code>    &lt;html&gt;\n\n    &lt;head&gt;\n    &lt;meta charset='utf-8' /&gt;\n    &lt;title&gt;Edificios&lt;/title&gt;\n    &lt;meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' /&gt;\n    &lt;script src='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js'&gt;&lt;/script&gt;\n    &lt;link href='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css' rel='stylesheet' /&gt;\n    &lt;link href='css/estilobase.css' rel='stylesheet' /&gt;\n\n    &lt;script src='js/edificios.js'&gt;&lt;/script&gt;\n    &lt;script&gt;\n        //A\u00f1adir vuestor token y/o estilo !!\n        var map;\n        function init() {\n            mapboxgl.accessToken =\n                'pk.eyJ1IjoiZ2lzbWFzdGVybTIiLCJhIjoiY2plZHhubTQxMTNoYzMza3Rqa3kxYTdrOCJ9.53B1E6mKD_EQOVb2Y0-SsA';\n             map = new mapboxgl.Map({\n                container: 'map',\n                style: 'mapbox://styles/mapbox/dark-v10',\n                center: [2.16859, 41.3954],\n                zoom: 15,\n                attributionControl: false,\n                pitch: 45,\n                hash: true\n            });\n\n            map.addControl(new mapboxgl.AttributionControl({ compact: true }));\n            map.addControl(new mapboxgl.NavigationControl());\n\n            map.on('load', function () {\n\n                addEdificiosCapa();\n\n\n             }); //fin onload\n\n        } // final init\n    &lt;/script&gt;\n    &lt;/head&gt;\n\n    &lt;body onload=\"init()\"&gt;\n\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;/body&gt;\n\n    &lt;/html&gt;\n</code></pre> <p>visualizamos el mapa</p> <p>Descomentamos filtro y orden de capas para una mejor visualizaci\u00f3n en edificios.js \u00bfQue ha cambiado?</p> <pre><code>  function addEdificiosCapa() {\n\n    map.addSource(\"edificios_source\", {\n        \"type\": \"vector\",\n        \"url\": \"mapbox://gismasterm2.500eaqlm\"  // mapbox://Nuestor ID Tileset\n\n    }); //fin map source\n\n\n    map.addLayer({\n    \"id\": \"edificios\",\n    \"type\": \"fill-extrusion\",\n    \"source\": \"edificios_source\",\n    \"source-layer\": \"construcciones-3f5iwq\", // Nuestro nombre Tileset\n    \"maxzoom\": 21,\n    \"minzoom\": 15,\n    \"filter\": [\"&gt;\", \"numberOfFl\", 0],\n    \"paint\": {\n        \"fill-extrusion-color\": [\n            \"interpolate\", [\"linear\"], [\"number\", [\"get\", \"numberOfFl\"]],\n            0, \"#FFFFFF\",\n            1, \"#e6b03d\",\n            3, \"#e6b03d\",\n            6, \"#3de66d\",\n            9, \"#3de6b1\",\n            12, \"#22ecf0\",\n            15, \"#14b1fd\",\n            20, \"#3d73e6\",\n            40, \"#123a8f\",\n            80, \"#ce2f7e\",\n            100, \"transparent\"\n\n        ],\n        \"fill-extrusion-height\": [\"*\", 2, [\"to-number\", [\"get\", \"numberOfFl\"]]],\n        \"fill-extrusion-opacity\": 0.9\n    }\n}\n,\"road-label\"\n);  \n\n} //fin funcion\n</code></pre>"},{"location":"faq/#paso-5-opciones-de-filtro","title":"Paso 5: Opciones de filtro","text":"<ul> <li> <p>Vamos a crear una funcionalidad para filtrar edificios seg\u00fan su n\u00famero de pisos</p> </li> <li> <p>Creamos un elementos HTML de tipo <code>input:range</code> para poder filtrar</p> </li> </ul> <p>Programamos funciones fuera del mapa!!</p> <pre><code>    &lt;html&gt;\n\n    &lt;head&gt;\n    &lt;meta charset='utf-8' /&gt;\n    &lt;title&gt;Edificios&lt;/title&gt;\n    &lt;meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' /&gt;\n    &lt;script src='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js'&gt;&lt;/script&gt;\n    &lt;link href='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css' rel='stylesheet' /&gt;\n    &lt;link href='css/estilobase.css' rel='stylesheet' /&gt;\n\n    &lt;script src='js/edificios.js'&gt;&lt;/script&gt;\n    &lt;script&gt;\n        //A\u00f1adir vuestor token y/o estilo !!\n        var map;\n        function init() {\n            mapboxgl.accessToken =\n                'pk.eyJ1IjoiZ2lzbWFzdGVybTIiLCJhIjoiY2plZHhubTQxMTNoYzMza3Rqa3kxYTdrOCJ9.53B1E6mKD_EQOVb2Y0-SsA';\n             map = new mapboxgl.Map({\n                container: 'map',\n                style: 'mapbox://styles/mapbox/dark-v10',\n                center: [2.16859, 41.3954],\n                zoom: 15,\n                attributionControl: false,\n                pitch: 45,\n                hash: true\n            });\n\n            map.addControl(new mapboxgl.AttributionControl({ compact: true }));\n            map.addControl(new mapboxgl.NavigationControl());\n\n            map.on('load', function () {\n\n                addEdificiosCapa();\n\n\n             }); //fin onload\n\n        } // final init\n    &lt;/script&gt;\n    &lt;/head&gt;\n\n    &lt;body onload=\"init()\"&gt;\n    &lt;div class=\"panelTopIzquierda\"&gt;\n\n        &lt;label id=\"altura\"&gt;M\u00e1s de 0 pisos&lt;/label&gt;\n        &lt;input id=\"slider\" type=\"range\" min=\"1\" max=\"50\" step=\"1\" value=\"0\" /&gt;\n    &lt;/div&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;/body&gt;\n\n    &lt;/html&gt;\n</code></pre> <ul> <li>A\u00f1adimos a estilobase.css las siguientes clases</li> </ul> <pre><code>.panelTopIzquierda {\n    position: absolute;\n    top: 18px;\n    left: 20px;\n    width: 200px;\n    z-index: 1000;\n    background-color: rgba(255,255,255,0.9);\n    padding: 10px;\n    font-size: 20px;\n    color: #33333;\n    border-radius: 5px;\n}\n\n.panelTopIzquierda label{\n    font-size:0.85em;\n}\n\n.panelTopIzquierda input[type=range]{\n    cursor:pointer;\n    width: 95%;\n}\n</code></pre>"},{"location":"faq/#paso-6-funcion-de-filtro","title":"Paso 6: Funci\u00f3n de filtro","text":"<ul> <li>A\u00f1adimos a  edificios.js la funcion filtrarEdificios()</li> </ul> <pre><code>    function filtrarEdificios(valor) {\n        map.setFilter(\"edificios\", [\"&gt;\", \"numberOfFl\", parseInt(valor)]);\n\n        document.getElementById(\"altura\").innerHTML = \"M\u00e1s de  &lt;b&gt;\" + valor + \"&lt;/b&gt; pisos\";\n\n    }\n</code></pre>"},{"location":"faq/#paso-7-evento-onchange","title":"Paso 7: Evento onChange","text":"<ul> <li>LLamamos a la funci\u00f3n de desde el evento <code>onChange</code> del objeto input de HTML</li> </ul> <pre><code>    &lt;html&gt;\n\n    &lt;head&gt;\n    &lt;meta charset='utf-8' /&gt;\n    &lt;title&gt;Edificios&lt;/title&gt;\n    &lt;meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' /&gt;\n    &lt;script src='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js'&gt;&lt;/script&gt;\n    &lt;link href='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css' rel='stylesheet' /&gt;\n    &lt;link href='css/estilobase.css' rel='stylesheet' /&gt;\n    &lt;script src='js/utils.js'&gt;&lt;/script&gt;\n    &lt;script src='js/edificios.js'&gt;&lt;/script&gt;\n    &lt;script&gt;\n        //A\u00f1adir vuestor token y/o estilo !!\n        var map;\n        function init() {\n            mapboxgl.accessToken =\n                'pk.eyJ1IjoiZ2lzbWFzdGVybTIiLCJhIjoiY2plZHhubTQxMTNoYzMza3Rqa3kxYTdrOCJ9.53B1E6mKD_EQOVb2Y0-SsA';\n             map = new mapboxgl.Map({\n                container: 'map',\n                style: 'mapbox://styles/mapbox/dark-v10',\n                center: [2.16859, 41.3954],\n                zoom: 15,\n                attributionControl: false,\n                pitch: 45,\n                hash: true\n            });\n\n            map.addControl(new mapboxgl.AttributionControl({ compact: true }));\n            map.addControl(new mapboxgl.NavigationControl());\n\n            map.on('load', function () {\n\n                addEdificiosCapa();\n\n                addPopupToMap(\"edificios\");\n             }); //fin onload\n\n        } // final init\n    &lt;/script&gt;\n    &lt;/head&gt;\n\n    &lt;body onload=\"init()\"&gt;\n    &lt;div class=\"panelTopIzquierda\"&gt;\n\n       &lt;label id=\"altura\"&gt;M\u00e1s de 0 pisos&lt;/label&gt;\n        &lt;input  onChange=\"filtrarEdificios(this.value)\" id=\"slider\" type=\"range\" min=\"1\" max=\"50\" step=\"1\" value=\"0\" /&gt;\n    &lt;/div&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;/body&gt;\n\n    &lt;/html&gt;\n</code></pre>"},{"location":"faq/#paso-8-eventos-click-i-popup","title":"Paso 8: Eventos Click i popup","text":"<p>Nuevas posibilidades de mapbox</p> <p>https://docs.mapbox.com/mapbox-gl-js/api/map/#map.event:click</p> <p>https://docs.mapbox.com/mapbox-gl-js/api/markers/#popup</p> <p>A\u00f1adir funcion Popup personalizado dentro de edificios.js</p> <pre><code>function addPopupToMapEdificios(nombreCapa) {\n\n    map.on('click', nombreCapa, function (e) {\n\n        var text = \"\";\n        //console.info(e);\n        for (key in e.features[0].properties) {\n\n            if (key == \"numberOfFl\") {\n                text += \"&lt;b&gt;Numero de plantas&lt;/b&gt;:\" + e.features[0].properties[key] + \"&lt;br&gt;\";\n            }\n            if (key == \"localId\") {\n                //localId 0004702DF3800C_part1\n                //http://ovc.catastro.meh.es/OVCServWeb/OVCWcfLibres/OVCFotoFachada.svc/RecuperarFotoFachadaGet?ReferenciaCatastral=0004701DF3800C\n                //https://www1.sedecatastro.gob.es/CYCBienInmueble/OVCListaBienes.aspx?rc1=0004701&amp;rc2=DF3800C\n\n                var localId = e.features[0].properties[key];\n\n                var localIdSplit = localId.split(\"_\"); // 0004702DF3800C  part1\n                var parte1 = localIdSplit[0].substring(0, 7);\n                var parte2 = localIdSplit[0].substring(7, localIdSplit[0].length);\n                text += \"&lt;img width=200 src=http://ovc.catastro.meh.es/OVCServWeb/OVCWcfLibres/OVCFotoFachada.svc/RecuperarFotoFachadaGet?ReferenciaCatastral=\" + localId + \"&gt;&lt;br&gt;\";\n                text += \"&lt;a target=blank href=https://www1.sedecatastro.gob.es/CYCBienInmueble/OVCListaBienes.aspx?rc1=\" + parte1 + \"&amp;rc2=\" + parte2 + \"&gt;Ficha&lt;/a&gt;&lt;br&gt;\";\n\n            }\n\n\n        }\n        new mapboxgl.Popup()\n            .setLngLat(e.lngLat)\n            .setHTML(text)\n            .addTo(map);\n\n    });\n\n    map.on('mouseenter', nombreCapa, function () {\n        map.getCanvas().style.cursor = 'pointer';\n    });\n\n    map.on('mouseleave', nombreCapa, function () {\n        map.getCanvas().style.cursor = '';\n    });\n\n}\n</code></pre>"},{"location":"faq/#paso-9-llamamos-funcion-addpopuptomapedificios","title":"Paso 9: Llamamos funci\u00f3n addPopupToMapEdificios","text":"<ul> <li>LLamamos a la funci\u00f3n de desde el evento <code>load</code> del mapa</li> </ul> <pre><code>    &lt;html&gt;\n\n    &lt;head&gt;\n    &lt;meta charset='utf-8' /&gt;\n    &lt;title&gt;Edificios&lt;/title&gt;\n    &lt;meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' /&gt;\n    &lt;script src='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js'&gt;&lt;/script&gt;\n    &lt;link href='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css' rel='stylesheet' /&gt;\n    &lt;link href='css/estilobase.css' rel='stylesheet' /&gt;\n    &lt;script src='js/utils.js'&gt;&lt;/script&gt;\n    &lt;script src='js/edificios.js'&gt;&lt;/script&gt;\n    &lt;script&gt;\n        //A\u00f1adir vuestor token y/o estilo !!\n        var map;\n        function init() {\n            mapboxgl.accessToken =\n                'pk.eyJ1IjoiZ2lzbWFzdGVybTIiLCJhIjoiY2plZHhubTQxMTNoYzMza3Rqa3kxYTdrOCJ9.53B1E6mKD_EQOVb2Y0-SsA';\n             map = new mapboxgl.Map({\n                container: 'map',\n                style: 'mapbox://styles/mapbox/dark-v10',\n                center: [2.16859, 41.3954],\n                zoom: 15,\n                attributionControl: false,\n                pitch: 45,\n                hash: true\n            });\n\n            map.addControl(new mapboxgl.AttributionControl({ compact: true }));\n            map.addControl(new mapboxgl.NavigationControl());\n\n            map.on('load', function () {\n\n                addEdificiosCapa();\n\n                addPopupToMapEdificios(\"edificios\");\n             }); //fin onload\n\n        } // final init\n    &lt;/script&gt;\n    &lt;/head&gt;\n\n    &lt;body onload=\"init()\"&gt;\n    &lt;div class=\"panelTopIzquierda\"&gt;\n\n       &lt;label id=\"altura\"&gt;M\u00e1s de 0 pisos&lt;/label&gt;\n        &lt;input  onChange=\"filtrarEdificios(this.value)\" id=\"slider\" type=\"range\" min=\"1\" max=\"50\" step=\"1\" value=\"0\" /&gt;\n    &lt;/div&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;/body&gt;\n\n    &lt;/html&gt;\n</code></pre> <p>Visualizamos mapa</p> <p></p> <p>Geocodificador Mapbox GL  https://github.com/mapbox/mapbox-gl-geocoder/blob/master/API.md</p> <pre><code>    &lt;html&gt;\n\n    &lt;head&gt;\n    &lt;meta charset='utf-8' /&gt;\n    &lt;title&gt;Edificios&lt;/title&gt;\n    &lt;meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' /&gt;\n    &lt;script src='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js'&gt;&lt;/script&gt;\n    &lt;link href='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css' rel='stylesheet' /&gt;\n   &lt;script src=\"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.min.js\"&gt;&lt;/script&gt;\n&lt;link rel=\"stylesheet\" href=\"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.css\" type=\"text/css\"&gt;\n    &lt;link href='css/estilobase.css' rel='stylesheet' /&gt;\n\n    &lt;script src='js/edificios.js'&gt;&lt;/script&gt;\n    &lt;script&gt;\n        //A\u00f1adir vuestor token y/o estilo !!\n        var map;\n        function init() {\n            mapboxgl.accessToken =\n                'pk.eyJ1IjoiZ2lzbWFzdGVybTIiLCJhIjoiY2plZHhubTQxMTNoYzMza3Rqa3kxYTdrOCJ9.53B1E6mKD_EQOVb2Y0-SsA';\n             map = new mapboxgl.Map({\n                container: 'map',\n                style: 'mapbox://styles/mapbox/dark-v10',\n                center: [2.16859, 41.3954],\n                zoom: 15,\n                attributionControl: false,\n                pitch: 45,\n                hash: true\n            });\n\n            map.addControl(new mapboxgl.AttributionControl({ compact: true }));\n            map.addControl(new mapboxgl.NavigationControl());\n\n            map.addControl(\n                new MapboxGeocoder({\n                accessToken: mapboxgl.accessToken,\n                mapboxgl: mapboxgl\n                }));\n\n            map.on('load', function () {\n\n                addEdificiosCapa();\n\n                addPopupToMapEdificios(\"edificios\");\n             }); //fin onload\n\n        } // final init\n    &lt;/script&gt;\n    &lt;/head&gt;\n\n    &lt;body onload=\"init()\"&gt;\n   &lt;div class=\"panelTopIzquierda\"&gt;\n\n       &lt;label id=\"altura\"&gt;M\u00e1s de 0 pisos&lt;/label&gt;\n        &lt;input  onChange=\"filtrarEdificios(this.value)\" id=\"slider\" type=\"range\" min=\"1\" max=\"50\" step=\"1\" value=\"0\" /&gt;\n    &lt;/div&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;/body&gt;\n\n    &lt;/html&gt;\n</code></pre> <p>Miramos opciones de Geocoder. \u00bfLimit\u00e1mos b\u00fasquedas del geocoder por caja de coordenadas de Barcelona?</p> <p>https://github.com/mapbox/mapbox-gl-geocoder/blob/main/API.md</p> <p><code>bbox:[2.1066 , 41.3000 , 2.2536 , 41.4468]</code></p> <p>\u00bfPonemos t\u00edtulo?</p> <p>\u00bfEditamos index.html y subimos el ejemplo al GitHub?</p> <pre><code>    git pull\n    git add .\n    git commit -m \"visor catastro\"\n    git push\n</code></pre>"},{"location":"faq/#saber-mas","title":"Saber m\u00e1s..","text":"<p>Forma reactiva de hacer lo mismo en el evento onchange</p> <pre><code> document.getElementById(\"slider\").onchange = function() {\n\n                filtrarEdificios(this.value)\n            }\n</code></pre> <p>Activar/ desactivar capa via c\u00f3digo</p> <pre><code>    map.setLayoutProperty(\"edificios\", \"visibility\", \"visible\");\n    map.setLayoutProperty(\"edificios\", \"visibility\", \"none\");\n</code></pre> <p>desactivar capas cuyo id contenga 'label'</p> <pre><code>            for (var i=0; i &lt; map.getStyle().layers.length;i++){\n\n                    if(map.getStyle().layers[i].id.indexOf(\"label\")!=-1){\n\n                        map.setLayoutProperty(map.getStyle().layers[i].id, \"visibility\", \"none\");\n                    }\n\n                }\n</code></pre>"},{"location":"faq/#nivel-avanzado","title":"Nivel avanzado..","text":"<ul> <li>Podemos programas el evento click sobre el mapa y no sobre una capa conresta, obtener los vectores de todas las capas y filtrar por la capa que nos interesa.</li> <li>La funci\u00f3n addPopupToMapEdificios quedaria as\u00ed y funcionaria en 2d c\u00f3mo en 3d</li> </ul> <pre><code>    function addPopupToMapEdificios(nombreCapa) {\n\n    map.on('click', function (e) {\n\n        var text = \"\";\n        var bbox = [[e.point.x - 10, e.point.y - 10], [e.point.x + 10, e.point.y + 10]];\n        var features = map.queryRenderedFeatures(bbox, { layers: [nombreCapa] });\n\n        if (features.length &gt; 0) {\n            for (key in features[0].properties) {\n\n                if (key == \"numberOfFl\") {\n                    text += \"&lt;b&gt;Numero de plantas&lt;/b&gt;:\" + features[0].properties[key] + \"&lt;br&gt;\";\n                }\n                if (key == \"localId\") {\n                    //localId 0004702DF3800C_part1\n                    //http://ovc.catastro.meh.es/OVCServWeb/OVCWcfLibres/OVCFotoFachada.svc/RecuperarFotoFachadaGet?ReferenciaCatastral=0004701DF3800C\n                    //https://www1.sedecatastro.gob.es/CYCBienInmueble/OVCListaBienes.aspx?rc1=0004701&amp;rc2=DF3800C\n\n                    var localId = features[0].properties[key];\n\n                    var localIdSplit = localId.split(\"_\"); // 0004702DF3800C  part1\n                    var parte1 = localIdSplit[0].substring(0, 7);\n                    var parte2 = localIdSplit[0].substring(7, localIdSplit[0].length);\n                    text += \"&lt;img width=200 src=http://ovc.catastro.meh.es/OVCServWeb/OVCWcfLibres/OVCFotoFachada.svc/RecuperarFotoFachadaGet?ReferenciaCatastral=\" + localId + \"&gt;&lt;br&gt;\";\n                    text += \"&lt;a target=blank href=https://www1.sedecatastro.gob.es/CYCBienInmueble/OVCListaBienes.aspx?rc1=\" + parte1 + \"&amp;rc2=\" + parte2 + \"&gt;Ficha&lt;/a&gt;&lt;br&gt;\";\n\n                }\n\n\n            }\n            new mapboxgl.Popup()\n                .setLngLat(e.lngLat)\n                .setHTML(text)\n                .addTo(map);\n        }\n\n    });\n\n    map.on('mouseenter', nombreCapa, function () {\n        map.getCanvas().style.cursor = 'pointer';\n    });\n\n    map.on('mouseleave', nombreCapa, function () {\n        map.getCanvas().style.cursor = '';\n    });\n\n}\n</code></pre>"}]}